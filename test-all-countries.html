<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´å›½å®¶æ•°æ®æµ‹è¯• - æ™ºèƒ½ç‰©æµæŠ¥ä»·æœºå™¨äºº</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 300;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card h3 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .company-section {
            margin: 30px 0;
            border: 1px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
        }

        .company-header {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
            font-size: 1.1em;
        }

        .service-row {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .service-row:last-child {
            border-bottom: none;
        }

        .service-name {
            font-weight: 600;
            color: #333;
        }

        .country-count {
            background: #007bff;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .countries-list {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
            line-height: 1.4;
        }

        .test-section {
            margin-top: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .test-controls select, .test-controls input, .test-controls button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .test-result {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #007bff;
        }

        .success { border-left-color: #28a745; }
        .error { border-left-color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š å®Œæ•´å›½å®¶æ•°æ®ç»Ÿè®¡</h1>
        
        <div class="stats-grid">
            <div class="stat-card">
                <h3>ç‰©æµå…¬å¸æ€»æ•°</h3>
                <div class="number" id="totalCompanies">-</div>
            </div>
            <div class="stat-card">
                <h3>æœåŠ¡æ¸ é“æ€»æ•°</h3>
                <div class="number" id="totalServices">-</div>
            </div>
            <div class="stat-card">
                <h3>æ”¯æŒå›½å®¶æ€»æ•°</h3>
                <div class="number" id="totalCountries">-</div>
            </div>
            <div class="stat-card">
                <h3>æ•°æ®è¦†ç›–ç‡</h3>
                <div class="number" id="coverageRate">-</div>
            </div>
        </div>

        <div id="companiesData"></div>

        <div class="test-section">
            <h3>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h3>
            <div class="test-controls">
                <select id="testCountry">
                    <option value="">é€‰æ‹©å›½å®¶æµ‹è¯•</option>
                </select>
                <input type="number" id="testWeight" placeholder="é‡é‡(KG)" step="0.1" min="0.001" value="1">
                <button onclick="testCountry()">æµ‹è¯•è®¡ç®—</button>
                <button onclick="runFullTest()">å…¨é¢æµ‹è¯•</button>
            </div>
            <div id="testResults"></div>
        </div>
    </div>

    <script src="scripts/complete-database.js"></script>
    <script>
        // ç­‰å¾…æ•°æ®åº“åˆå§‹åŒ–
        setTimeout(() => {
            displayStatistics();
            displayCompaniesData();
            populateCountrySelect();
        }, 100);

        function displayStatistics() {
            const db = window.completeLogisticsDB;
            
            const companies = db.getCompanies();
            const totalCompanies = companies.length;
            
            let totalServices = 0;
            companies.forEach(company => {
                totalServices += db.getServices(company).length;
            });
            
            const allCountries = db.getAllCountries();
            const totalCountries = allCountries.length;
            
            // è®¡ç®—è¦†ç›–ç‡ï¼ˆåŸºäºä¸–ç•Œä¸»è¦è´¸æ˜“å›½å®¶ï¼‰
            const majorTradeCountries = [
                'ç¾å›½', 'ä¸­å›½', 'å¾·å›½', 'æ—¥æœ¬', 'è‹±å›½', 'æ³•å›½', 'æ„å¤§åˆ©', 'éŸ©å›½',
                'åŠ æ‹¿å¤§', 'è¥¿ç­ç‰™', 'è·å…°', 'æ¾³å¤§åˆ©äºš', 'æ–°åŠ å¡', 'ç‘å£«', 'æ¯”åˆ©æ—¶',
                'å°åº¦', 'å¢¨è¥¿å“¥', 'ä¿„ç½—æ–¯', 'å·´è¥¿', 'é˜¿è”é…‹'
            ];
            const coveredMajorCountries = majorTradeCountries.filter(country => 
                allCountries.includes(country)
            ).length;
            const coverageRate = Math.round((coveredMajorCountries / majorTradeCountries.length) * 100);
            
            document.getElementById('totalCompanies').textContent = totalCompanies;
            document.getElementById('totalServices').textContent = totalServices;
            document.getElementById('totalCountries').textContent = totalCountries;
            document.getElementById('coverageRate').textContent = coverageRate + '%';
        }

        function displayCompaniesData() {
            const db = window.completeLogisticsDB;
            const companies = db.getCompanies();
            let html = '';
            
            companies.forEach(company => {
                const services = db.getServices(company);
                html += `<div class="company-section">`;
                html += `<div class="company-header">${company}</div>`;
                
                services.forEach(service => {
                    const countries = db.getCountries(company, service);
                    html += `<div class="service-row">`;
                    html += `<div>`;
                    html += `<div class="service-name">${service}</div>`;
                    html += `<div class="countries-list">${countries.join('ã€')}</div>`;
                    html += `</div>`;
                    html += `<div class="country-count">${countries.length}ä¸ªå›½å®¶</div>`;
                    html += `</div>`;
                });
                
                html += `</div>`;
            });
            
            document.getElementById('companiesData').innerHTML = html;
        }

        function populateCountrySelect() {
            const db = window.completeLogisticsDB;
            const countries = db.getAllCountries();
            const select = document.getElementById('testCountry');
            
            countries.forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                select.appendChild(option);
            });
        }

        function testCountry() {
            const country = document.getElementById('testCountry').value;
            const weight = parseFloat(document.getElementById('testWeight').value) || 1;
            
            if (!country) {
                alert('è¯·é€‰æ‹©å›½å®¶');
                return;
            }
            
            const db = window.completeLogisticsDB;
            const results = db.compareAllPrices(country, weight);
            
            let html = `<div class="test-result ${results.length > 0 ? 'success' : 'error'}">`;
            html += `<h4>æµ‹è¯•ç»“æœï¼š${country} (${weight}KG)</h4>`;
            
            if (results.length > 0) {
                html += `<p>æ‰¾åˆ° ${results.length} ä¸ªå¯ç”¨æ–¹æ¡ˆï¼š</p>`;
                results.slice(0, 5).forEach((result, index) => {
                    html += `<p>${index + 1}. ${result.company} - ${result.service} - `;
                    if (result.zone) html += `${result.zone} - `;
                    html += `Â¥${result.totalPrice.toFixed(2)} ($${result.totalPriceUSD.toFixed(2)})`;
                    html += ` - ${result.timeframe}</p>`;
                });
            } else {
                html += `<p>âŒ è¯¥å›½å®¶æš‚æ— å¯ç”¨æœåŠ¡</p>`;
            }
            
            html += `</div>`;
            document.getElementById('testResults').innerHTML = html;
        }

        function runFullTest() {
            const db = window.completeLogisticsDB;
            const countries = db.getAllCountries();
            const testWeight = 1;
            
            let successCount = 0;
            let totalCount = countries.length;
            let failedCountries = [];
            
            countries.forEach(country => {
                const results = db.compareAllPrices(country, testWeight);
                if (results.length > 0) {
                    successCount++;
                } else {
                    failedCountries.push(country);
                }
            });
            
            let html = `<div class="test-result ${failedCountries.length === 0 ? 'success' : 'error'}">`;
            html += `<h4>å…¨é¢æµ‹è¯•ç»“æœ</h4>`;
            html += `<p>æµ‹è¯•é‡é‡ï¼š${testWeight}KG</p>`;
            html += `<p>æµ‹è¯•å›½å®¶ï¼š${totalCount}ä¸ª</p>`;
            html += `<p>æˆåŠŸè®¡ç®—ï¼š${successCount}ä¸ª (${Math.round(successCount/totalCount*100)}%)</p>`;
            
            if (failedCountries.length > 0) {
                html += `<p>è®¡ç®—å¤±è´¥ï¼š${failedCountries.length}ä¸ª</p>`;
                html += `<p>å¤±è´¥å›½å®¶ï¼š${failedCountries.join('ã€')}</p>`;
            } else {
                html += `<p>âœ… æ‰€æœ‰å›½å®¶éƒ½èƒ½æ­£å¸¸è®¡ç®—ï¼</p>`;
            }
            
            html += `</div>`;
            document.getElementById('testResults').innerHTML = html;
        }
    </script>
</body>
</html> 