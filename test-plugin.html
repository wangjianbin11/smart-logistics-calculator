<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰©æµæŠ¥ä»·æœºå™¨äºº - åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5; 
        }
        .test-container { 
            background: white; 
            padding: 20px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            max-width: 800px; 
            margin: 0 auto; 
        }
        .test-section { 
            margin-bottom: 30px; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 8px; 
        }
        .test-title { 
            color: #333; 
            font-size: 18px; 
            margin-bottom: 10px; 
            font-weight: bold; 
        }
        .test-result { 
            background: #f8f9fa; 
            padding: 10px; 
            border-radius: 5px; 
            margin-top: 10px; 
            font-family: monospace; 
            white-space: pre-wrap; 
        }
        .success { 
            background: #d4edda; 
            color: #155724; 
        }
        .error { 
            background: #f8d7da; 
            color: #721c24; 
        }
        .button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 8px 16px; 
            border-radius: 4px; 
            cursor: pointer; 
            margin: 5px; 
        }
        .button:hover { 
            background: #0056b3; 
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª ç‰©æµæŠ¥ä»·æœºå™¨äºº - åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <div class="test-title">ğŸ“¦ æ•°æ®åº“åˆå§‹åŒ–æµ‹è¯•</div>
            <button class="button" onclick="testDatabaseInit()">æµ‹è¯•æ•°æ®åº“åˆå§‹åŒ–</button>
            <div id="databaseTest" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸ¢ ç‰©æµå…¬å¸è·å–æµ‹è¯•</div>
            <button class="button" onclick="testGetCompanies()">è·å–ç‰©æµå…¬å¸åˆ—è¡¨</button>
            <div id="companiesTest" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸš› æœåŠ¡è·å–æµ‹è¯•</div>
            <button class="button" onclick="testGetServices()">è·å–ä¸‡é‚¦ç‰©æµæœåŠ¡</button>
            <button class="button" onclick="testGetServicesYuntu()">è·å–äº‘é€”ç‰©æµæœåŠ¡</button>
            <div id="servicesTest" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸŒ å›½å®¶è·å–æµ‹è¯•</div>
            <button class="button" onclick="testGetCountries()">è·å–ä¸‡é‚¦ç‰©æµæœè£…ä¸“çº¿å›½å®¶</button>
            <div id="countriesTest" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸ’° ä»·æ ¼è®¡ç®—æµ‹è¯•</div>
            <button class="button" onclick="testCalculation1()">ä¸‡é‚¦ç‰©æµæœè£…ä¸“çº¿åˆ°ç¾å›½0.5kg</button>
            <button class="button" onclick="testCalculation2()">åç¿°ç‰©æµæ™®è´§é«˜ä»¿ä¸“çº¿åˆ°ç¾å›½0.5kg</button>
            <button class="button" onclick="testCalculation3()">äº‘é€”ç‰©æµæ ‡å‡†å¸¦ç”µåˆ°è‹±å›½1kg</button>
            <div id="calculationTest" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸ“Š æ¯”ä»·åŠŸèƒ½æµ‹è¯•</div>
            <button class="button" onclick="testComparison()">æ¯”ä»·ï¼šç¾å›½ï¼Œ0.5kgï¼Œæ™®è´§ç±»å‹</button>
            <div id="comparisonTest" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">ğŸ” æ™ºèƒ½ç­›é€‰æµ‹è¯•</div>
            <button class="button" onclick="testProductFilter()">æµ‹è¯•äº§å“ç±»å‹ç­›é€‰</button>
            <div id="filterTest" class="test-result"></div>
        </div>
    </div>

    <script src="scripts/enhanced-database.js"></script>
    <script>
        let database = null;
        
        function testDatabaseInit() {
            const result = document.getElementById('databaseTest');
            try {
                if (typeof LogisticsDatabase === 'undefined') {
                    result.textContent = 'âŒ é”™è¯¯: LogisticsDatabaseç±»æœªå®šä¹‰';
                    result.className = 'test-result error';
                    return;
                }
                
                database = new LogisticsDatabase();
                result.textContent = 'âœ… æˆåŠŸ: æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ';
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testGetCompanies() {
            const result = document.getElementById('companiesTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const companies = database.getCompanies();
                result.textContent = `âœ… æˆåŠŸ: è·å–åˆ° ${companies.length} å®¶ç‰©æµå…¬å¸\nå…¬å¸åˆ—è¡¨: ${companies.join(', ')}`;
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testGetServices() {
            const result = document.getElementById('servicesTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const services = database.getServices('ä¸‡é‚¦ç‰©æµ');
                result.textContent = `âœ… æˆåŠŸ: ä¸‡é‚¦ç‰©æµæœ‰ ${services.length} ä¸ªæœåŠ¡\næœåŠ¡åˆ—è¡¨: ${services.join(', ')}`;
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testGetServicesYuntu() {
            const result = document.getElementById('servicesTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const services = database.getServices('äº‘é€”ç‰©æµ');
                result.textContent = `âœ… æˆåŠŸ: äº‘é€”ç‰©æµæœ‰ ${services.length} ä¸ªæœåŠ¡\næœåŠ¡åˆ—è¡¨: ${services.join(', ')}`;
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testGetCountries() {
            const result = document.getElementById('countriesTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const countries = database.getCountries('ä¸‡é‚¦ç‰©æµ', 'æœè£…ä¸“çº¿');
                result.textContent = `âœ… æˆåŠŸ: ä¸‡é‚¦ç‰©æµæœè£…ä¸“çº¿æ”¯æŒ ${countries.length} ä¸ªå›½å®¶\nå›½å®¶åˆ—è¡¨: ${countries.join(', ')}`;
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testCalculation1() {
            const result = document.getElementById('calculationTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const calc = database.calculateShipping('ä¸‡é‚¦ç‰©æµ', 'æœè£…ä¸“çº¿', 'ç¾å›½', 0.5);
                if (calc.success) {
                    result.textContent = `âœ… æˆåŠŸ: ä¸‡é‚¦ç‰©æµæœè£…ä¸“çº¿åˆ°ç¾å›½0.5kg\n` +
                        `å…¬æ–¤è´¹: Â¥${calc.perKgRate}/kg\n` +
                        `æ“ä½œè´¹: Â¥${calc.handlingFee}\n` +
                        `æ€»è´¹ç”¨: Â¥${calc.totalCost}\n` +
                        `è®¡ç®—å…¬å¼: 0.5kg Ã— Â¥${calc.perKgRate} + Â¥${calc.handlingFee} = Â¥${calc.totalCost}`;
                    result.className = 'test-result success';
                } else {
                    result.textContent = `âŒ è®¡ç®—å¤±è´¥: ${calc.error}`;
                    result.className = 'test-result error';
                }
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testCalculation2() {
            const result = document.getElementById('calculationTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const calc = database.calculateShipping('åç¿°ç‰©æµ', 'æ™®è´§é«˜ä»¿ä¸“çº¿', 'ç¾å›½', 0.5);
                if (calc.success) {
                    result.textContent = `âœ… æˆåŠŸ: åç¿°ç‰©æµæ™®è´§é«˜ä»¿ä¸“çº¿åˆ°ç¾å›½0.5kg\n` +
                        `å…¬æ–¤è´¹: Â¥${calc.perKgRate}/kg\n` +
                        `æ“ä½œè´¹: Â¥${calc.handlingFee}\n` +
                        `æ€»è´¹ç”¨: Â¥${calc.totalCost}\n` +
                        `è®¡ç®—å…¬å¼: 0.5kg Ã— Â¥${calc.perKgRate} + Â¥${calc.handlingFee} = Â¥${calc.totalCost}`;
                    result.className = 'test-result success';
                } else {
                    result.textContent = `âŒ è®¡ç®—å¤±è´¥: ${calc.error}`;
                    result.className = 'test-result error';
                }
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testCalculation3() {
            const result = document.getElementById('calculationTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const calc = database.calculateShipping('äº‘é€”ç‰©æµ', 'æ ‡å‡†å¸¦ç”µ', 'è‹±å›½', 1.0);
                if (calc.success) {
                    result.textContent = `âœ… æˆåŠŸ: äº‘é€”ç‰©æµæ ‡å‡†å¸¦ç”µåˆ°è‹±å›½1kg\n` +
                        `å…¬æ–¤è´¹: Â¥${calc.perKgRate}/kg\n` +
                        `æ“ä½œè´¹: Â¥${calc.handlingFee}\n` +
                        `æ€»è´¹ç”¨: Â¥${calc.totalCost}\n` +
                        `è®¡ç®—å…¬å¼: 1kg Ã— Â¥${calc.perKgRate} + Â¥${calc.handlingFee} = Â¥${calc.totalCost}`;
                    result.className = 'test-result success';
                } else {
                    result.textContent = `âŒ è®¡ç®—å¤±è´¥: ${calc.error}`;
                    result.className = 'test-result error';
                }
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testComparison() {
            const result = document.getElementById('comparisonTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                const comparisons = database.compareAllPrices('ç¾å›½', 0.5, 'æ™®è´§');
                result.textContent = `âœ… æˆåŠŸ: æ‰¾åˆ° ${comparisons.length} ä¸ªæ¯”ä»·é€‰é¡¹\n\n`;
                
                comparisons.forEach((comp, index) => {
                    result.textContent += `${index + 1}. ${comp.company} - ${comp.service}\n` +
                        `   æ€»è´¹ç”¨: Â¥${comp.totalCost} (å…¬æ–¤è´¹: Â¥${comp.perKgRate}/kg, æ“ä½œè´¹: Â¥${comp.handlingFee})\n\n`;
                });
                
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testProductFilter() {
            const result = document.getElementById('filterTest');
            try {
                if (!database) {
                    result.textContent = 'âŒ é”™è¯¯: è¯·å…ˆåˆå§‹åŒ–æ•°æ®åº“';
                    result.className = 'test-result error';
                    return;
                }
                
                // æµ‹è¯•äº§å“ç±»å‹ç­›é€‰
                const testCases = [
                    ['æ™®è´§', 'æ™®è´§é«˜ä»¿ä¸“çº¿'],
                    ['æœè£…', 'æœè£…ä¸“çº¿'],
                    ['åŒ–å¦†å“', 'åŒ–å¦†å“ä¸“çº¿'],
                    ['å¸¦ç”µäº§å“', 'æ ‡å‡†å¸¦ç”µ'],
                    ['ä»¿ç‰Œ', 'æ™®è´§é«˜ä»¿ä¸“çº¿']
                ];
                
                let output = 'âœ… äº§å“ç±»å‹ç­›é€‰æµ‹è¯•:\n\n';
                
                testCases.forEach(([productType, serviceName]) => {
                    const isMatch = database.isServiceSuitableForProduct(serviceName, productType);
                    output += `äº§å“ç±»å‹: "${productType}" | æœåŠ¡: "${serviceName}" | åŒ¹é…: ${isMatch ? 'âœ…' : 'âŒ'}\n`;
                });
                
                result.textContent = output;
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `âŒ é”™è¯¯: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“
        window.onload = function() {
            testDatabaseInit();
        };
    </script>
</body>
</html> 