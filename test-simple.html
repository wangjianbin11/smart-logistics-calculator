<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®åº“åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .result {
            background: #e8f5e8;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 4px solid #4caf50;
        }
        .error {
            background: #ffeaea;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 4px solid #f44336;
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #1976D2;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç‰©æµæ•°æ®åº“åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>åŸºç¡€åŠŸèƒ½æµ‹è¯•</h2>
        <button onclick="testBasicFunctions()">æµ‹è¯•åŸºç¡€åŠŸèƒ½</button>
        <div id="basicResults"></div>
    </div>

    <div class="test-section">
        <h2>è®¡ç®—åŠŸèƒ½æµ‹è¯•</h2>
        <button onclick="testCalculations()">æµ‹è¯•è®¡ç®—åŠŸèƒ½</button>
        <div id="calcResults"></div>
    </div>

    <div class="test-section">
        <h2>æ¯”ä»·åŠŸèƒ½æµ‹è¯•</h2>
        <button onclick="testComparison()">æµ‹è¯•æ™ºèƒ½æ¯”ä»·</button>
        <div id="compResults"></div>
    </div>

    <script src="scripts/enhanced-database.js"></script>
    <script>
        let db = null;

        document.addEventListener('DOMContentLoaded', function() {
            try {
                db = window.logisticsDB;
                log('ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸï¼', 'basicResults');
            } catch (error) {
                log('ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼š' + error.message, 'basicResults', true);
            }
        });

        function log(message, containerId, isError = false) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = isError ? 'error' : 'result';
            div.innerHTML = message;
            container.appendChild(div);
        }

        function testBasicFunctions() {
            const container = document.getElementById('basicResults');
            container.innerHTML = '';

            try {
                // æµ‹è¯•è·å–å…¬å¸åˆ—è¡¨
                const companies = db.getCompanies();
                log(`âœ… è·å–åˆ° ${companies.length} å®¶ç‰©æµå…¬å¸ï¼š${companies.join(', ')}`, 'basicResults');

                // æµ‹è¯•äº‘é€”ç‰©æµæœåŠ¡
                const yuntuServices = db.getServices('äº‘é€”ç‰©æµ');
                log(`âœ… äº‘é€”ç‰©æµæœåŠ¡æ•°é‡ï¼š${yuntuServices.length}`, 'basicResults');
                log(`äº‘é€”ç‰©æµæœåŠ¡åˆ—è¡¨ï¼š${yuntuServices.join(', ')}`, 'basicResults');

                // æµ‹è¯•ä¸‡é‚¦ç‰©æµå›½å®¶
                const wanbaoCountries = db.getCountries('ä¸‡é‚¦ç‰©æµ', 'æœè£…ä¸“çº¿');
                log(`âœ… ä¸‡é‚¦ç‰©æµæœè£…ä¸“çº¿æ”¯æŒ ${wanbaoCountries.length} ä¸ªå›½å®¶ï¼š${wanbaoCountries.join(', ')}`, 'basicResults');

                // æµ‹è¯•æ¾³å¤§åˆ©äºšåˆ†åŒº
                const auZones = db.getZones('äº‘é€”ç‰©æµ', 'æœè£…ä¸“çº¿', 'æ¾³å¤§åˆ©äºš');
                log(`âœ… äº‘é€”ç‰©æµæœè£…ä¸“çº¿æ¾³å¤§åˆ©äºšæ”¯æŒ ${auZones.length} ä¸ªåˆ†åŒºï¼š${auZones.join(', ')}`, 'basicResults');

            } catch (error) {
                log('âŒ åŸºç¡€åŠŸèƒ½æµ‹è¯•å¤±è´¥ï¼š' + error.message, 'basicResults', true);
            }
        }

        function testCalculations() {
            const container = document.getElementById('calcResults');
            container.innerHTML = '';

            try {
                // æµ‹è¯•ä¸‡é‚¦ç‰©æµç¾å›½è®¡ç®—
                const result1 = db.calculateShipping('ä¸‡é‚¦ç‰©æµ', 'æœè£…ä¸“çº¿', 'ç¾å›½', 1.5);
                if (result1) {
                    log(`âœ… ä¸‡é‚¦ç‰©æµæœè£…ä¸“çº¿åˆ°ç¾å›½1.5kgï¼šÂ¥${result1.totalPrice.toFixed(2)}`, 'calcResults');
                    log(`   è¯¦æƒ…ï¼š${result1.details}`, 'calcResults');
                } else {
                    log('âŒ ä¸‡é‚¦ç‰©æµè®¡ç®—å¤±è´¥', 'calcResults', true);
                }

                // æµ‹è¯•äº‘é€”ç‰©æµæ¾³å¤§åˆ©äºšåˆ†åŒºè®¡ç®—
                const result2 = db.calculateShipping('äº‘é€”ç‰©æµ', 'æœè£…ä¸“çº¿', 'æ¾³å¤§åˆ©äºš', 2.0, '1åŒº');
                if (result2) {
                    log(`âœ… äº‘é€”ç‰©æµæœè£…ä¸“çº¿åˆ°æ¾³å¤§åˆ©äºš1åŒº2kgï¼šÂ¥${result2.totalPrice.toFixed(2)}`, 'calcResults');
                    log(`   è¯¦æƒ…ï¼š${result2.details}`, 'calcResults');
                } else {
                    log('âŒ äº‘é€”ç‰©æµæ¾³å¤§åˆ©äºšè®¡ç®—å¤±è´¥', 'calcResults', true);
                }

                // æµ‹è¯•ç‡•æ–‡ç‰©æµæ—¥æœ¬é¦–é‡ç»­é‡è®¡ç®—
                const result3 = db.calculateShipping('ç‡•æ–‡ç‰©æµ', 'ç‡•æ–‡ä¸“çº¿è¿½è¸ª', 'æ—¥æœ¬', 1.2);
                if (result3) {
                    log(`âœ… ç‡•æ–‡ç‰©æµä¸“çº¿è¿½è¸ªåˆ°æ—¥æœ¬1.2kgï¼šÂ¥${result3.totalPrice.toFixed(2)}`, 'calcResults');
                    log(`   è¯¦æƒ…ï¼š${result3.details}`, 'calcResults');
                } else {
                    log('âŒ ç‡•æ–‡ç‰©æµæ—¥æœ¬è®¡ç®—å¤±è´¥', 'calcResults', true);
                }

            } catch (error) {
                log('âŒ è®¡ç®—åŠŸèƒ½æµ‹è¯•å¤±è´¥ï¼š' + error.message, 'calcResults', true);
            }
        }

        function testComparison() {
            const container = document.getElementById('compResults');
            container.innerHTML = '';

            try {
                // æµ‹è¯•ç¾å›½æ¯”ä»·
                const results = db.compareAllPrices('ç¾å›½', 1.0);
                log(`âœ… ç¾å›½1kgæ¯”ä»·ç»“æœï¼šæ‰¾åˆ° ${results.length} ä¸ªæ–¹æ¡ˆ`, 'compResults');
                
                if (results.length > 0) {
                    const best = results[0];
                    log(`ğŸ¥‡ æœ€ä¼˜æ–¹æ¡ˆï¼š${best.company} - ${best.service}ï¼Œä»·æ ¼ï¼šÂ¥${best.totalPrice.toFixed(2)}`, 'compResults');
                    
                    results.slice(0, 3).forEach((result, index) => {
                        const savings = index === 0 ? 0 : result.totalPrice - best.totalPrice;
                        const extra = savings > 0 ? ` (+Â¥${savings.toFixed(2)})` : '';
                        log(`${index + 1}. ${result.company} - ${result.service}ï¼šÂ¥${result.totalPrice.toFixed(2)}${extra}`, 'compResults');
                    });
                }

                // æµ‹è¯•è‹±å›½æ¯”ä»·
                const ukResults = db.compareAllPrices('è‹±å›½', 0.5);
                log(`âœ… è‹±å›½0.5kgæ¯”ä»·ç»“æœï¼šæ‰¾åˆ° ${ukResults.length} ä¸ªæ–¹æ¡ˆ`, 'compResults');

            } catch (error) {
                log('âŒ æ¯”ä»·åŠŸèƒ½æµ‹è¯•å¤±è´¥ï¼š' + error.message, 'compResults', true);
            }
        }
    </script>
</body>
</html> 