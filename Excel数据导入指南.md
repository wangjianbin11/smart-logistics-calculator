# Excel数据导入指南

## 概述

您可以通过Excel表格的方式批量导入物流费率数据。根据您提供的价格表格式，我们已经设计了相应的数据结构。

## Excel表格格式要求

### 必需列名（请严格按照以下列名创建Excel表格）：

| 列名 | 说明 | 示例 |
|------|------|------|
| **国家** | 目的地国家中文名 | 英国、美国、德国、法国 |
| **产品代码** | 物流服务代码 | EXRPH、UKEXRPH、USEXRPH |
| **产品名称** | 物流服务中文名称 | 英国快线普货、美国快线普货 |
| **参考时效** | 工作日数 | 4-6、5-7、6-9 |
| **重量限制** | 重量范围 | 0-0.3、0.301-1、1.001-2、2.001-15 |
| **尺寸限制** | 包裹尺寸限制 | 60*40*40cm 体积<0.031m³ |
| **公斤价** | 每公斤价格（人民币） | 40、42、44、46 |
| **操作费** | 操作费（人民币/票） | 16、23、26、30 |
| **备注** | 特殊说明 | 尾程Yodel、偏远地区限重等 |

### 示例数据行：

```
国家    产品代码   产品名称      参考时效  重量限制     尺寸限制                     公斤价  操作费  备注
英国    EXRPH     英国快线普货   4-6      0-0.3       60*40*40cm 体积<0.031m³      40     16     尾程Yodel
英国    EXRPH     英国快线普货   4-6      0.301-1     60*40*40cm 体积<0.031m³      42     16     尾程Yodel
英国    EXRPH     英国快线普货   4-6      1.001-2     60*40*40cm 体积<0.031m³      44     16     尾程Yodel
德国    EXRPH     德国快线普货   5-7      0-0.5       60*40*40cm Min size:15*11*1cm 52     23     
美国    USEXRPH   美国快线普货   6-9      0-0.1       55*45*38cm L+2*(W+H)=274cm   88     30     尾程标记: WanB/WanbExpress
```

## 数据准备步骤

### 1. 创建Excel文件
- 使用Microsoft Excel或类似软件创建新文件
- 第一行为列标题（请严格按照上表的列名）
- 从第二行开始输入数据

### 2. 数据整理建议
- **每个重量段一行**：同一个服务的不同重量段需要分别创建行
- **保持数据一致性**：同一国家、同一服务的基本信息（产品名称、时效、尺寸限制）应保持一致
- **重量格式统一**：使用类似 "0-0.3"、"0.301-1" 的格式表示重量范围

### 3. 当前已支持的数据
基于您的价格表，我们已经预设了以下数据：

#### 英国 (GB)
- **EXRPH**: 英国快线普货 (4-6天)
- **UKEXRPH**: 英国快线普货 (4-6天，Evri尾程)

#### 德国 (DE)
- **EXRPH**: 德国快线普货 (5-7天)

#### 法国 (FR)
- **EXRPH**: 法国快线普货 (5-7天)

#### 美国 (US)
- **USEXRPH**: 美国快线普货 (6-9天)

## 扩展数据准备

### 如果您要添加更多国家和服务：

1. **新增国家**：
   - 在Excel中添加新的国家名称
   - 确保国家名称使用中文
   - 我们会自动为新国家生成相应的配置

2. **新增服务代码**：
   - 可以创建任意的服务代码（如 DHL-STD、FEDEX-IE等）
   - 建议使用简短、有意义的代码

3. **复杂费率结构**：
   - 支持任意数量的重量段
   - 支持不同国家的不同费率结构

## 导入流程

1. **准备Excel文件**：按照上述格式整理您的数据
2. **转换为CSV**：将Excel文件另存为CSV格式（UTF-8编码）
3. **通过设置页面导入**：
   - 点击插件的 "数据管理" 链接
   - 在设置页面找到 "批量导入" 功能
   - 选择您的CSV文件进行导入

## 费率计算逻辑

导入后，系统将按照以下逻辑计算费用：

```
实际物流费 = max(重量 × 公斤价, 操作费)
```

这与您价格表中的计算方式完全一致。

## 注意事项

1. **数据备份**：导入前请备份现有数据
2. **逐步导入**：建议先导入少量数据测试，确认无误后再批量导入
3. **数据验证**：导入完成后，建议测试几个报价以验证数据准确性

## 下一步计划

完成基础数据导入后，我们将继续开发：

1. **更多国家支持**：全球主要国家的费率管理
2. **多物流公司**：DHL、FedEx、UPS等主流物流商
3. **动态汇率**：实时汇率更新功能
4. **高级费率规则**：燃油附加费、偏远地区费等

---

**准备好Excel数据后，请提供给我，我将帮您完成批量导入功能的开发！** 